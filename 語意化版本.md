# 語意化版本

> 參考資料：
>
> [語意化版本 2.0.0](https://semver.org/lang/zh-TW/)

## 摘要

版本格式：主板號.次版號.修訂號，版號遞增規則如下：

1. 主板號：當推出一個不相容的 API 修改。
2. 次版號：當推出一個向下相容的功能性新增。
3. 修訂號：當推出一個向下相容的問題修正。

先行版號及版本編譯資訊可以加到 "主版本號.次版本號.修訂號" 的後面作為延伸。

## 簡介

當系統規模越大，加入的套件越多，就越有可能在未來的某一天發現自己身陷絕望之中。

再相依性高的系統中發佈新版本套件，可能很快就會變成惡夢。如果相依性關係過高，可能面臨版本控制被鎖死的風險(必須對每一個相依套件改版，才能完成某次升級)。而如果相依性過於鬆散
，又將無法避免版本混亂(假設相容於未來的多個版本已超出合理數量)。當你專案的進展因為版本相依被鎖死或版本混亂變得不夠簡便和可靠，就意味你正處於相依性地獄中。

而語意化版本就是這個問題的解決方案之一。這些規則是根據(但不局限於)各種已經封閉、開放源碼軟體所廣泛應用的慣例所設計。為了讓這套理論運作，你必須先定義好的公共 API。這可以透過文件定義或程式碼強制要求來實限。無論如何，這套 API 的清楚明瞭是十分重要的。一旦你定義了公共 API。這可以透過修改相應的版號來向大家說明你的修改。考慮使用這樣的版號格式：X.Y.Z(主版號.次版號.修訂號)修復問題但不影響 API 時，遞增修訂號；API 保持向下相容的新增修改時，地增次版號；進行不向下相同的修改時，遞增主版號。

## 語意版本控制規範

1. 使用語意化版本控制的軟體必須(MUST)定義公共 API。該 API 可以在程式碼中被定義出來或出現於嚴謹的文件內。無論何種形式都應該(SHOULD)力求精確且完整。
2. 標準的版號必須(MUST)採用 X.Y.Z 格式，其中 X、Y 和 Z 為非負的整數，且禁止(MUST NOT)在數字前方補零。X 為主版號，Y 為次版號，Z 為修訂號。每個元素必須(MUST)以數值來遞增。例如：1.9.1 -> 1.10.0 -> 1.11.0。
3. 標記版號的軟體發行後，禁止(MUST NOT)改變該版本軟體的內容。任何修改都必須(MUST)以新版本發行。
4. 主版本號為零(0.y.z)的軟體處於開發初始階段，一切都可以(MAY)隨時改變。這樣的公共 API 不應該(SHOULD NOT)被視為穩定版。
5. 1.0.0 的版號用於界定公共 API 的形成。這一版之後所有的版號更新都基於公共 API 及其修改內容。
6. 修訂號 z 必須(MUST)在只做了向下相容的修正時才遞增。這裡的修正指的是針對不正確結果而進行的內部修改。
7. 次版號 y 必須(MUST)在有向下相容的新功能出現時遞增。在任何公共 API 的功能被標記為棄用時，也必需(MUST)遞增。也可以(MAY)在內部程式有大量新功能或改進被加入時遞增，其中可以(MAY)包括修訂級別的改變。每當次版號遞增時，修訂號必須(MUST)歸零。
8. 主版號 x 必須(MUST)在有任何不相容的修改被加入公共 API 時遞增。其中可以(MAY)包括次版號及修訂級別的改變。每當主版號遞增時，次版號和修訂號必須(MUST)歸零。
9. 先行版號可以(MAY)被標註在修訂版之後，先加上一個連接號再加上一連串以句點分隔的標示符號來修飾。標示符號必須(MUST)由 ASCII 碼的英數字和連接號組成，且禁止(MUST NOT)留白。數字型的標示符號禁止(MUST NOT)在前方補零。先行版的優先級低於相關聯的標準版。被標上先行版號則表示這個版號並非穩定且可能無法達到相容的需求。範例：1.0.0-alpha、1.0.0-alpha.1、1.0.0-0.3.7、1.0.0-x.7.z.92、1.0.0-x-y-z.–。
10. 版本編譯資訊可以(MAY)被標註在修訂版或先行版之後，先加上一個加號再加上一連串以句點分隔的標示符號來修飾。標示符號必須(MUST)由 ASCII 的英數字和連接號組成，且禁止(MUST NOT)留白。當判斷版本的優先層級時，版本編譯資訊必須(MUST)被忽略。因此當兩個版本只有在版本編譯資訊有差別時，屬於相同的優先層級。範例：1.0.0-alpha+001、1.0.0+20130313144700、1.0.0-beta+exp.sha.5114f85、1.0.0+21AF26D3—-117B344092BD。
11. 版本的優先層級指的是不同版本在排序時如何比較。
    1. 判斷優先層級時，必須(MUST)把版本依序拆分為主版號、次版號、修訂號及先行版號後進行比較(版本資訊不在此比較的範疇中)。
    2. 由左到右依序比較每個標示符號，第一個差異值用來決定優先層級：主辦號、次版號及修訂號以數值比較。例如：1.0.0 < 2.0.0 < 2.1.0 < 2.1.1。
    3. 當主版號、次版號及修訂號都相同時，有先行版號者優先層級較低。例如：1.0.0-alpha < 1.0.0。
    4. 有相同主版號、次版號及修訂號的兩個先行版號，其優先必須(MUST)透過由左到右每個被句點分隔的標示符號來做比較，值到找到一個差異值後決。
